{"version":3,"file":"IED.test.js","sourceRoot":"","sources":["../../../../test/integration/editors/IED.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { expect, fixture, html } from '@open-wc/testing';\n\nimport { LitElement } from 'lit-element';\n\nimport { IconButton } from '@material/mwc-icon-button';\nimport '@material/mwc-icon-button';\n\nimport '../../mock-open-scd.js';\nimport '../../../src/editors/IED.js';\n\nimport { initializeNsdoc, Nsdoc } from '../../../src/foundation/nsdoc.js';\nimport { FilterButton } from '../../../src/oscd-filter-button.js';\n\nimport IED from '../../../src/editors/IED.js';\nimport { LDeviceContainer } from '../../../src/editors/ied/ldevice-container.js';\nimport { LNContainer } from '../../../src/editors/ied/ln-container.js';\nimport { DOContainer } from '../../../src/editors/ied/do-container.js';\nimport { DAContainer } from '../../../src/editors/ied/da-container.js';\nimport { MockOpenSCD } from '../../mock-open-scd.js';\n\ndescribe('IED Plugin', () => {\n  if (customElements.get('ied-plugin') === undefined)\n    customElements.define('ied-plugin', IED);\n  let element: IED;\n  let parent: MockOpenSCD;\n  let nsdoc: Nsdoc;\n\n  describe('without a doc loaded', () => {\n    beforeEach(async () => {\n      parent = await fixture(\n        html`<mock-open-scd><ied-plugin></ied-plugin></mock-open-scd>`\n      );\n      element = parent.getActivePlugin();\n      await element.requestUpdate();\n      await element.updateComplete;\n    });\n\n    it('looks like the latest snapshot', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n  });\n\n  describe('with a doc loaded', () => {\n    let doc: XMLDocument;\n\n    describe('containing no IEDs', () => {\n      beforeEach(async () => {\n        doc = await fetch('/test/testfiles/editors/iedEditorWithoutIEDs.scd')\n          .then(response => response.text())\n          .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n        nsdoc = await initializeNsdoc();\n        parent = await fixture(\n          html`<mock-open-scd\n            ><ied-plugin .doc=\"${doc}\" .nsdoc=\"${nsdoc}\"></ied-plugin\n          ></mock-open-scd>`\n        );\n        element = parent.getActivePlugin();\n        await element.requestUpdate();\n        await element.updateComplete;\n      });\n\n      it('looks like the latest snapshot', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n    });\n\n    describe('Open Services Wizard', () => {\n      beforeEach(async () => {\n        doc = await fetch('/test/testfiles/Services.scd')\n          .then(response => response.text())\n          .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n        nsdoc = await initializeNsdoc();\n\n        parent = await fixture(\n          html`<mock-open-scd\n            ><ied-plugin .doc=${doc} .nsdoc=${nsdoc}></ied-plugin\n          ></mock-open-scd>`\n        );\n        element = parent.getActivePlugin();\n\n        await element.requestUpdate();\n        await element.updateComplete;\n\n        await selectIed('WithServices');\n        await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n      });\n\n      it('Should open Services wizard', async () => {\n        element\n          .shadowRoot!.querySelector('ied-container')!\n          .shadowRoot!.querySelector<HTMLElement>(\n            'mwc-icon-button[icon=\"settings\"]'\n          )!\n          .click();\n\n        await element.requestUpdate();\n\n        expect(parent.wizardUI).to.exist;\n      });\n    });\n\n    describe('containing IEDs', () => {\n      beforeEach(async () => {\n        doc = await fetch('/test/testfiles/editors/iedEditorWithIEDs.scd')\n          .then(response => response.text())\n          .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n        nsdoc = await initializeNsdoc();\n        parent = await fixture(\n          html`<mock-open-scd\n            ><ied-plugin .doc=\"${doc}\" .nsdoc=\"${nsdoc}\"></ied-plugin\n          ></mock-open-scd>`\n        );\n        element = parent.getActivePlugin();\n        await element.requestUpdate();\n        await element.updateComplete;\n      });\n\n      it('looks like the latest snapshot', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n\n      it('then initially the first IED is selected and rendered', () => {\n        expect(\n          element.shadowRoot?.querySelectorAll('ied-container').length\n        ).to.eql(1);\n        expect(\n          element.shadowRoot\n            ?.querySelector('ied-container')!\n            .shadowRoot?.querySelector('action-pane')!.shadowRoot?.innerHTML\n        ).to.include('IED1');\n      });\n\n      it('when other IED selected then IED Container contains the correct IED', async () => {\n        expect(\n          element.shadowRoot?.querySelectorAll('ied-container').length\n        ).to.eql(1);\n        expect(\n          getIedContainer().shadowRoot?.querySelector('action-pane')!.shadowRoot\n            ?.innerHTML\n        ).to.include('IED1');\n\n        await selectIed('IED3');\n        await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n\n        expect(\n          element.shadowRoot?.querySelectorAll('ied-container').length\n        ).to.eql(1);\n        expect(\n          getIedContainer().shadowRoot?.querySelector('action-pane')!.shadowRoot\n            ?.innerHTML\n        ).to.include('IED3');\n      });\n\n      it('when filtering LN Classes then correct number of LN Containers are rendered', async () => {\n        expect(\n          getLDeviceContainer(getIedContainer()).shadowRoot!.querySelectorAll(\n            'ln-container'\n          ).length\n        ).to.eql(5);\n\n        await selectLNClasses('CSWI');\n        await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n\n        expect(\n          getLDeviceContainer(getIedContainer()).shadowRoot!.querySelectorAll(\n            'ln-container'\n          ).length\n        ).to.eql(2);\n      });\n\n      it('when other IED selected, all LNs are selected by default', async () => {\n        await selectLNClasses('XCBR');\n\n        await selectIed('IED3');\n        await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n\n        expect(\n          element.shadowRoot?.querySelectorAll('ied-container').length\n        ).to.eql(1);\n        expect(\n          getIedContainer().shadowRoot?.querySelector('action-pane')!.shadowRoot\n            ?.innerHTML\n        ).to.include('IED3');\n\n        expect(\n          getLDeviceContainer(getIedContainer()).shadowRoot!.querySelectorAll(\n            'ln-container'\n          ).length\n        ).to.eql(9);\n      });\n\n      it('when filtering LNs, if none are selected, all are selected', async () => {\n        await selectIed('IED3');\n\n        const oscdFilterButton = <FilterButton>(\n          element.shadowRoot!.querySelector(\n            'oscd-filter-button[id=\"lnClassesFilter\"]'\n          )\n        );\n        const filterButton = <IconButton>(\n          oscdFilterButton!.shadowRoot!.querySelector('mwc-icon-button')\n        );\n        filterButton.click();\n        await element.updateComplete;\n\n        const primaryButton = <HTMLElement>(\n          oscdFilterButton!.shadowRoot!.querySelector(\n            'mwc-button[slot=\"primaryAction\"]'\n          )\n        );\n        primaryButton.click();\n        await element.updateComplete;\n\n        await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n\n        expect(\n          getLDeviceContainer(getIedContainer()).shadowRoot!.querySelectorAll(\n            'ln-container'\n          ).length\n        ).to.eql(9);\n      });\n\n      it('then renders the path of elements correctly', async () => {\n        const iedContainer = getIedContainer();\n\n        // Initially there won't be a path shown.\n        expect(getElementPathValue()).to.be.empty;\n\n        // After setting the focus on the IED Container\n        iedContainer.dispatchEvent(new Event('focus'));\n        await element.updateComplete;\n        expect(getElementPathValue()).to.eql('IED1');\n\n        // After setting the focus on the Server Container below the IED Container\n        const lDeviceContainer = getLDeviceContainer(iedContainer);\n        lDeviceContainer!.dispatchEvent(new Event('focus'));\n        await element.updateComplete;\n        expect(getElementPathValue()).to.eql(\n          'IED1 / P1 / Server / CircuitBreaker_CB1'\n        );\n\n        // After removing the focus on the IED Container, it will be empty again.\n        iedContainer!.dispatchEvent(new Event('blur'));\n        await element.updateComplete;\n        expect(getElementPathValue()).to.be.empty;\n      });\n\n      // Add test for create wizard DAI when clicking add icon in DA Container (see issue #1139)\n      describe('when DA allows for multiple Val', () => {\n        beforeEach(async () => {\n          doc = await fetch('/test/testfiles/wizards/settingGroups.scd')\n            .then(response => response.text())\n            .then(str =>\n              new DOMParser().parseFromString(str, 'application/xml')\n            );\n          nsdoc = await initializeNsdoc();\n          parent = await fixture(\n            html`<mock-open-scd\n              ><ied-plugin .doc=\"${doc}\" .nsdoc=\"${nsdoc}\"></ied-plugin\n            ></mock-open-scd>`\n          );\n          element = parent.getActivePlugin();\n          await element.requestUpdate();\n          await element.updateComplete;\n        });\n        it('shows correct wizard when navigating to the DA container that allows for multiple Val and clicking Add', async () => {\n          const lnContainer: LNContainer = getLDeviceContainerByInst(\n            getIedContainer(),\n            'stage1'\n          )!.shadowRoot!.querySelectorAll('ln-container')[1] as LNContainer;\n\n          lnContainer.shadowRoot!.querySelector('mwc-icon-button-toggle')!.on =\n            true;\n          await lnContainer.requestUpdate();\n\n          // await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n          const doContainer: DOContainer = lnContainer\n            .shadowRoot!.querySelector('action-pane')!\n            .querySelector('do-container')!;\n\n          doContainer.shadowRoot!.querySelector('mwc-icon-button-toggle')!.on =\n            true;\n          await doContainer.requestUpdate();\n\n          // await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n\n          const daContainer: DAContainer =\n            doContainer.shadowRoot!.querySelector('da-container')!;\n          daContainer\n            .shadowRoot!.querySelector('action-pane')!\n            .querySelector('mwc-icon-button-toggle')!.on = true;\n          await daContainer.requestUpdate();\n\n          // await new Promise(resolve => setTimeout(resolve, 100)); // await animation\n\n          (daContainer\n            .shadowRoot!.querySelector('da-container')!\n            .shadowRoot!.querySelector(\n              'mwc-icon-button[icon=\"add\"]'\n            ) as HTMLElement)!.click();\n\n          await parent.updateComplete;\n\n          expect(parent.wizardUI.dialogs.length).to.equal(1);\n          expect(\n            parent.wizardUI.dialogs[0]!.querySelectorAll('wizard-textfield')\n              .length\n          ).to.equal(3);\n        });\n      });\n\n      function getIedContainer(): Element {\n        return element.shadowRoot!.querySelector('ied-container')!;\n      }\n\n      function getLDeviceContainer(iedContainer: Element): Element {\n        return iedContainer\n          .shadowRoot!.querySelector('access-point-container')!\n          .shadowRoot!.querySelector('server-container')!\n          .shadowRoot!.querySelector('ldevice-container')!;\n      }\n\n      function getLDeviceContainerByInst(\n        iedContainer: Element,\n        instName: string\n      ): Element | undefined {\n        return (\n          Array.from(\n            iedContainer!\n              .shadowRoot!.querySelector('access-point-container')!\n              .shadowRoot!.querySelector('server-container')!\n              .shadowRoot!.querySelectorAll('ldevice-container')\n          ) as LDeviceContainer[]\n        ).find(lDevice => lDevice.element.getAttribute('inst') === instName);\n      }\n\n      function getElementPathValue(): string {\n        return (\n          element.shadowRoot\n            ?.querySelector('element-path')\n            ?.shadowRoot?.querySelector('h3')?.textContent ?? ''\n        );\n      }\n\n      async function selectLNClasses(lnClass: string): Promise<void> {\n        const oscdFilterButton = <FilterButton>(\n          element.shadowRoot!.querySelector(\n            'oscd-filter-button[id=\"lnClassesFilter\"]'\n          )\n        );\n        const filterButton = <IconButton>(\n          oscdFilterButton!.shadowRoot!.querySelector('mwc-icon-button')\n        );\n        filterButton.click();\n        await element.updateComplete;\n\n        (<HTMLElement>(\n          oscdFilterButton!.querySelector(\n            `mwc-check-list-item[value=\"${lnClass}\"]`\n          )\n        )).click();\n\n        const primaryButton = <HTMLElement>(\n          oscdFilterButton!.shadowRoot!.querySelector(\n            'mwc-button[slot=\"primaryAction\"]'\n          )\n        );\n        primaryButton.click();\n        await element.updateComplete;\n      }\n    });\n  });\n\n  async function selectIed(name: string): Promise<void> {\n    const oscdFilterButton = element.shadowRoot!.querySelector(\n      'oscd-filter-button[id=\"iedFilter\"]'\n    );\n    const filterButton = <HTMLElement>(\n      oscdFilterButton!.shadowRoot!.querySelector('mwc-icon-button')\n    );\n    filterButton.click();\n    await element.updateComplete;\n\n    const selectItem = <HTMLElement>(\n      oscdFilterButton!.querySelector(`mwc-radio-list-item[value=\"${name}\"]`)\n    );\n    selectItem.click();\n\n    const primaryButton = <HTMLElement>(\n      oscdFilterButton!.shadowRoot!.querySelector(\n        'mwc-button[slot=\"primaryAction\"]'\n      )\n    );\n    primaryButton.click();\n\n    await element.updateComplete;\n  }\n});\n"]}