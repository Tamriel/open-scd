{"version":3,"file":"UpdateDescritionABB.test.js","sourceRoot":"","sources":["../../../../test/integration/menu/UpdateDescritionABB.test.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,kBAAkB,CAAC;AAEzD,OAAO,wBAAwB,CAAC;AAGhC,OAAO,oBAAoB,MAAM,2CAA2C,CAAC;AAE7E,QAAQ,CAAC,+CAA+C,EAAE,GAAG,EAAE;IAC7D,IAAI,cAAc,CAAC,GAAG,CAAC,wBAAwB,CAAC,KAAK,SAAS;QAC5D,cAAc,CAAC,MAAM,CAAC,wBAAwB,EAAE,oBAAoB,CAAC,CAAC;IAExE,IAAI,MAAmB,CAAC;IACxB,IAAI,OAA6B,CAAC;IAClC,IAAI,GAAgB,CAAC;IAErB,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,GAAG,GAAG,MAAM,KAAK,CAAC,8CAA8C,CAAC;aAC9D,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;aACjC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,SAAS,EAAE,CAAC,eAAe,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAC,CAAC;QAExE,MAAM,GAAG,MAAM,OAAO,CAAC,IAAI,CAAA;;;;KAI1B,CAAC,CAAC;QAEH,OAAO,GAAG,MAAM,CAAC,eAAe,EAAE,CAAC;QAEnC,OAAO,CAAC,GAAG,GAAG,GAAG,CAAC;QAClB,OAAO,CAAC,GAAG,EAAE,CAAC;QACd,MAAM,MAAM,CAAC,aAAa,EAAE,CAAC;IAC/B,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6EAA6E,EAAE,KAAK,IAAI,EAAE;QAC3F,MAAM,CACJ,GAAG,CAAC,aAAa,CACf,kEAAkE,CACnE,CACF,CAAC,EAAE,CAAC,KAAK,CAAC;QACX,MAAM,CAAC,QAAQ,EAAE,MAAM;YACrB,EAAE,aAAa,CAAc,kCAAkC,CAAE;aAChE,KAAK,EAAE,CAAC;QACX,MAAM,MAAM,CAAC,cAAc,CAAC;QAC5B,MAAM,CACJ,GAAG,CAAC,aAAa,CACf,gFAAgF,CACjF,CACF,CAAC,EAAE,CAAC,KAAK,CAAC;IACb,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oFAAoF,EAAE,KAAK,IAAI,EAAE;QAClG,MAAM,CACJ,GAAG,CAAC,aAAa,CACf,kEAAkE,CACnE,CACF,CAAC,EAAE,CAAC,KAAK,CAAC;QACX,MAAM,CAAC,QAAQ,EAAE,MAAM;YACrB,EAAE,aAAa,CAAc,kCAAkC,CAAE;aAChE,KAAK,EAAE,CAAC;QACX,MAAM,MAAM,CAAC,cAAc,CAAC;QAC5B,MAAM,CACJ,GAAG,CAAC,aAAa,CACf,kEAAkE,CACnE,CACF,CAAC,EAAE,CAAC,KAAK,CAAC;IACb,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import { expect, fixture, html } from '@open-wc/testing';\n\nimport '../../mock-open-scd.js';\nimport { MockOpenSCD } from '../../mock-open-scd.js';\n\nimport UpdateDescriptionAbb from '../../../src/menu/UpdateDescriptionABB.js';\n\ndescribe('Update method for desc attributes in ABB IEDs', () => {\n  if (customElements.get('update-description-abb') === undefined)\n    customElements.define('update-description-abb', UpdateDescriptionAbb);\n\n  let parent: MockOpenSCD;\n  let element: UpdateDescriptionAbb;\n  let doc: XMLDocument;\n\n  beforeEach(async () => {\n    doc = await fetch('/test/testfiles/updatedesc/updatedescABB.scd')\n      .then(response => response.text())\n      .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n    parent = await fixture(html`\n      <mock-open-scd\n        ><update-description-abb></update-description-abb\n      ></mock-open-scd>\n    `);\n\n    element = parent.getActivePlugin();\n\n    element.doc = doc;\n    element.run();\n    await parent.requestUpdate();\n  });\n\n  it('creates desc attributes for ExtRef elements with existing intAddr attribute', async () => {\n    expect(\n      doc.querySelector(\n        'IED[name=\"IED1\"] LN[lnClass=\"CSWI\"][inst=\"1\"] ExtRef:not([desc])'\n      )\n    ).to.exist;\n    parent.wizardUI?.dialog\n      ?.querySelector<HTMLElement>('mwc-button[slot=\"primaryAction\"]')!\n      .click();\n    await parent.updateComplete;\n    expect(\n      doc.querySelector(\n        'IED[name=\"IED1\"] LN[lnClass=\"CSWI\"][inst=\"1\"] ExtRef[desc=\"GOOSERCV_BIN.3.I1\"]'\n      )\n    ).to.exist;\n  });\n\n  it('does not create desc attributes for ExtRef elements with missing intAddr attribute', async () => {\n    expect(\n      doc.querySelector(\n        'IED[name=\"IED1\"] LN[lnClass=\"CSWI\"][inst=\"2\"] ExtRef:not([desc])'\n      )\n    ).to.exist;\n    parent.wizardUI?.dialog\n      ?.querySelector<HTMLElement>('mwc-button[slot=\"primaryAction\"]')!\n      .click();\n    await parent.updateComplete;\n    expect(\n      doc.querySelector(\n        'IED[name=\"IED1\"] LN[lnClass=\"CSWI\"][inst=\"2\"] ExtRef:not([desc])'\n      )\n    ).to.exist;\n  });\n});\n"]}