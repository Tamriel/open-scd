{"version":3,"file":"CompareIED.test.js","sourceRoot":"","sources":["../../../../test/unit/menu/CompareIED.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { expect, fixture, html } from '@open-wc/testing';\n\nimport CompareIEDPlugin from '../../../src/menu/CompareIED.js';\nimport { PlainCompareList } from '../../../src/plain-compare-list.js';\n\ndescribe('Compare IED Plugin', () => {\n  if (customElements.get('compare-ied') === undefined)\n    customElements.define('compare-ied', CompareIEDPlugin);\n\n  let plugin: CompareIEDPlugin;\n  let doc: XMLDocument;\n  let template: XMLDocument;\n\n  beforeEach(async () => {\n    plugin = await fixture(html`<compare-ied></compare-ied>`);\n    doc = await fetch('/test/testfiles/menu/compare-ied-changed.scd')\n      .then(response => response.text())\n      .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n    template = await fetch('/test/testfiles/menu/compare-ied-original.scd')\n      .then(response => response.text())\n      .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n  });\n\n  describe('show template project selection dialog', () => {\n    beforeEach(async () => {\n      plugin.doc = doc;\n      plugin.run();\n      await plugin.requestUpdate();\n    });\n\n    it('after closing the dialog everything set to undefined', async () => {\n      expect(plugin.templateDoc).to.be.undefined;\n      expect(plugin.selectedProjectIed).to.be.undefined;\n      expect(plugin.selectedTemplateIed).to.be.undefined;\n\n      plugin['onClosed']();\n      await plugin.requestUpdate();\n\n      expect(plugin.templateDoc).to.be.undefined;\n      expect(plugin.selectedProjectIed).to.be.undefined;\n      expect(plugin.selectedTemplateIed).to.be.undefined;\n    });\n\n    it('looks like its latest snapshot', async () => {\n      await expect(plugin.dialog).to.equalSnapshot();\n    });\n  });\n\n  describe('show ied selection lists dialog', () => {\n    beforeEach(async () => {\n      plugin.doc = doc;\n      plugin.templateDoc = template;\n      plugin.run();\n      await plugin.requestUpdate();\n    });\n\n    it('expect the correct number of IEDs from project', () => {\n      expect(plugin.ieds).to.have.length(5);\n    });\n\n    it('expect the correct number of IEDs from template project', () => {\n      expect(plugin.templateIeds).to.have.length(4);\n    });\n\n    it('after closing the dialog everything set to undefined', async () => {\n      expect(plugin.templateDoc).to.not.be.undefined;\n      expect(plugin.selectedProjectIed).to.be.undefined;\n      expect(plugin.selectedTemplateIed).to.be.undefined;\n\n      plugin['onClosed']();\n      await plugin.requestUpdate();\n\n      // expect(plugin.templateDoc).to.be.undefined;\n      expect(plugin.selectedProjectIed).to.be.undefined;\n      expect(plugin.selectedTemplateIed).to.be.undefined;\n    });\n\n    it('looks like its latest snapshot', async () => {\n      await expect(plugin.dialog).to.equalSnapshot();\n    });\n  });\n\n  describe('show compare dialog with no differences', () => {\n    beforeEach(async () => {\n      plugin.doc = doc;\n      plugin.templateDoc = template;\n      plugin.selectedProjectIed =\n        doc.querySelector('IED[name=\"FieldC_QA1_QB1_QB2_QC9\"]') ?? undefined;\n      plugin.selectedTemplateIed =\n        template.querySelector('IED[name=\"FieldC_QA1_QB1_QB2_QC9\"]') ??\n        undefined;\n      plugin.run();\n      await plugin.requestUpdate();\n    });\n\n    it('looks like its latest snapshot', async () => {\n      await expect(plugin.dialog).to.equalSnapshot();\n    });\n  });\n\n  describe('show compare dialog with differences', () => {\n    beforeEach(async () => {\n      plugin.doc = doc;\n      plugin.templateDoc = template;\n      plugin.selectedProjectIed =\n        doc.querySelector('IED[name=\"FieldA_QA1_QB1_QB2_QC9\"]') ?? undefined;\n      plugin.selectedTemplateIed =\n        template.querySelector('IED[name=\"FieldA_QA1_QB1_QB2_QC9\"]') ??\n        undefined;\n      plugin.run();\n      await plugin.requestUpdate();\n    });\n\n    it('after closing the dialog everything set to undefined', async () => {\n      expect(plugin.templateDoc).to.not.be.undefined;\n      expect(plugin.selectedProjectIed).to.not.be.undefined;\n      expect(plugin.selectedTemplateIed).to.not.be.undefined;\n\n      plugin['onClosed']();\n      await plugin.requestUpdate();\n\n      expect(plugin.selectedProjectIed).to.be.undefined;\n      expect(plugin.selectedTemplateIed).to.be.undefined;\n    });\n\n  });\n\n});\n"]}