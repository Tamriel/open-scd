{"version":3,"file":"Waiting.test.js","sourceRoot":"","sources":["../../../test/unit/Waiting.test.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,kBAAkB,CAAC;AAEzD,OAAO,4BAA4B,CAAC;AAIpC,OAAO,EAAE,oBAAoB,EAAE,MAAM,yBAAyB,CAAC;AAE/D,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;IAC3B,IAAI,OAAmB,CAAC;IACxB,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,OAAO,GAAe,MAAM,OAAO,CAAC,IAAI,CAAA,6BAA6B,CAAC,CAAC;IACzE,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2CAA2C,EAAE,GAAG,EAAE,CACnD,MAAM,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;IAEnD,EAAE,CAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;QAC5D,MAAM,OAAO,GAAG,IAAI,OAAO,CAAO,OAAO,CAAC,EAAE,CAC1C,UAAU,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,QAAQ,CAAC,CAC3C,CAAC;QACF,OAAO,CAAC,aAAa,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC;QACrD,MAAM,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;QACnD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAO,OAAO,CAAC,EAAE,CAC1C,UAAU,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CACzC,CAAC;QACF,OAAO,CAAC,aAAa,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC;QACrD,MAAM,OAAO,CAAC;QACd,MAAM,OAAO,CAAC,QAAQ,CAAC;QACvB,MAAM,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;QAClD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAO,CAAC,QAAQ,EAAE,MAAM,EAAE,EAAE,CACrD,UAAU,CAAC,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CACxC,CAAC;QACF,OAAO,CAAC,aAAa,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC;QACrD,MAAM,OAAO,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;QAChC,MAAM,OAAO,CAAC,QAAQ,CAAC;QACvB,MAAM,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC;IAClD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import { html, fixture, expect } from '@open-wc/testing';\n\nimport '../../src/addons/Waiter.js';\n\nimport { OscdWaiter } from '../../src/addons/Waiter.js';\n\nimport { newPendingStateEvent } from '../../src/foundation.js';\n\ndescribe('OSCD-Waiter', () => {\n  let element: OscdWaiter;\n  beforeEach(async () => {\n    element = <OscdWaiter>await fixture(html`<oscd-waiter></oscd-waiter>`);\n  });\n\n  it('does not wait for pending state initially', () =>\n    expect(element).property('waiting').to.be.false);\n\n  it('starts waiting on incoming PendingStateEvent', async () => {\n    const promise = new Promise<void>(resolve =>\n      setTimeout(() => resolve(), 1500 /* ms */)\n    );\n    element.dispatchEvent(newPendingStateEvent(promise));\n    expect(element).property('waiting').to.be.true;\n  });\n\n  it('stops waiting on promise resolution', async () => {\n    const promise = new Promise<void>(resolve =>\n      setTimeout(() => resolve(), 20 /* ms */)\n    );\n    element.dispatchEvent(newPendingStateEvent(promise));\n    await promise;\n    await element.workDone;\n    expect(element).property('waiting').to.be.false;\n  });\n\n  it('stops waiting on promise rejection', async () => {\n    const promise = new Promise<void>((_resolve, reject) =>\n      setTimeout(() => reject(), 20 /* ms */)\n    );\n    element.dispatchEvent(newPendingStateEvent(promise));\n    await promise.catch(() => null);\n    await element.workDone;\n    expect(element).property('waiting').to.be.false;\n  });\n});\n"]}