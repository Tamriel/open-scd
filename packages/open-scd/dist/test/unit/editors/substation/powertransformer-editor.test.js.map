{"version":3,"file":"powertransformer-editor.test.js","sourceRoot":"","sources":["../../../../../test/unit/editors/substation/powertransformer-editor.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { fixture, html, expect } from '@open-wc/testing';\nimport { SinonSpy, spy } from 'sinon';\n\nimport '../../../../src/editors/substation/powertransformer-editor.js';\n\nimport { PowerTransformerEditor } from '../../../../src/editors/substation/powertransformer-editor.js';\nimport { isDelete } from '../../../../src/foundation.js';\n\ndescribe('powertransformer-editor', () => {\n  let element: PowerTransformerEditor;\n  let validSCL: XMLDocument;\n\n  let wizardEvent: SinonSpy;\n  let actionEvent: SinonSpy;\n\n  beforeEach(async () => {\n    validSCL = await fetch('/test/testfiles/valid2007B4withSubstationXY.scd')\n      .then(response => response.text())\n      .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n    element = <PowerTransformerEditor>(\n      await fixture(\n        html`<powertransformer-editor\n          .element=${validSCL.querySelector('PowerTransformer')}\n        ></powertransformer-editor>`\n      )\n    );\n\n    wizardEvent = spy();\n    window.addEventListener('wizard', wizardEvent);\n    actionEvent = spy();\n    window.addEventListener('editor-action', actionEvent);\n  });\n\n  describe('rendered as action icon', () => {\n    beforeEach(async () => {\n      element.showfunctions = false;\n      await element.requestUpdate();\n    });\n\n    it('looks like the latest snapshot', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n\n    it('triggers edit wizard for Linking LNode element on action button click', async () => {\n      (<HTMLElement>(\n        element.shadowRoot?.querySelector('mwc-fab[icon=\"account_tree\"]')\n      )).click();\n\n      await element.requestUpdate();\n\n      expect(wizardEvent).to.have.be.calledOnce;\n      expect(wizardEvent.args[0][0].detail.wizard()[0].title).to.contain(\n        'lnode'\n      );\n    });\n\n    it('triggers edit wizard for PowerTransformer element on action button click', async () => {\n      (<HTMLElement>(\n        element.shadowRoot?.querySelector('mwc-fab[icon=\"edit\"]')\n      )).click();\n\n      await element.requestUpdate();\n\n      expect(wizardEvent).to.have.be.calledOnce;\n      expect(wizardEvent.args[0][0].detail.wizard()[0].title).to.contain(\n        'edit'\n      );\n    });\n\n    it('triggers remove powertransformer action on action button click', async () => {\n      (<HTMLElement>(\n        element.shadowRoot?.querySelector('mwc-fab[icon=\"delete\"]')\n      )).click();\n\n      await element.requestUpdate();\n\n      expect(wizardEvent).to.not.have.been.called;\n      expect(actionEvent).to.have.been.calledOnce;\n      expect(actionEvent.args[0][0].detail.action).to.satisfy(isDelete);\n    });\n  });\n\n  describe('rendered as action pane', () => {\n    beforeEach(async () => {\n      element.showfunctions = true;\n      await element.requestUpdate();\n    });\n\n    it('looks like the latest snapshot', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n\n    describe('with EqFunction children', () => {\n      beforeEach(async () => {\n        const doc = await fetch('/test/testfiles/zeroline/functions.scd')\n          .then(response => response.text())\n          .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n        element.element = doc.querySelector('PowerTransformer[name=\"myPtr2\"]')!;\n        await element.requestUpdate();\n      });\n\n      it('looks like the latest snapshot', async () =>\n        await expect(element).shadowDom.to.equalSnapshot());\n    });\n\n    describe('with LNode children', () => {\n      beforeEach(async () => {\n        const doc = await fetch('/test/testfiles/zeroline/functions.scd')\n          .then(response => response.text())\n          .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n        element.element = doc.querySelector('PowerTransformer[name=\"myPtr1\"]')!;\n        await element.requestUpdate();\n      });\n\n      it('looks like the latest snapshot', async () =>\n        await expect(element).shadowDom.to.equalSnapshot());\n    });\n\n    describe('with SubEquipment children', () => {\n      beforeEach(async () => {\n        const doc = await fetch('/test/testfiles/SubEquipment.scd')\n          .then(response => response.text())\n          .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n        element.element = doc.querySelector('PowerTransformer[name=\"pTrans\"]')!;\n        await element.requestUpdate();\n      });\n\n      it('looks like the latest snapshot', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n    });\n\n    it('triggers edit wizard for Linking LNode element on action button click', async () => {\n      (<HTMLElement>(\n        element.shadowRoot?.querySelector(\n          'mwc-icon-button[icon=\"account_tree\"]'\n        )\n      )).click();\n\n      await element.requestUpdate();\n\n      expect(wizardEvent).to.have.be.calledOnce;\n      expect(wizardEvent.args[0][0].detail.wizard()[0].title).to.contain(\n        'lnode'\n      );\n    });\n\n    it('triggers edit wizard for PowerTransformer element on action button click', async () => {\n      (<HTMLElement>(\n        element.shadowRoot?.querySelector('mwc-icon-button[icon=\"edit\"]')\n      )).click();\n\n      await element.requestUpdate();\n\n      expect(wizardEvent).to.have.be.calledOnce;\n      expect(wizardEvent.args[0][0].detail.wizard()[0].title).to.contain(\n        'edit'\n      );\n    });\n\n    it('triggers remove powertransformer action on action button click', async () => {\n      (<HTMLElement>(\n        element.shadowRoot?.querySelector('mwc-icon-button[icon=\"delete\"]')\n      )).click();\n\n      await element.requestUpdate();\n\n      expect(wizardEvent).to.not.have.been.called;\n      expect(actionEvent).to.have.been.calledOnce;\n      expect(actionEvent.args[0][0].detail.action).to.satisfy(isDelete);\n    });\n  });\n});\n"]}