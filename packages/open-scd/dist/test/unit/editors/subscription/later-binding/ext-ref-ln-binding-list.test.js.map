{"version":3,"file":"ext-ref-ln-binding-list.test.js","sourceRoot":"","sources":["../../../../../../test/unit/editors/subscription/later-binding/ext-ref-ln-binding-list.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { expect, fixture, html } from '@open-wc/testing';\n\nimport { initializeNsdoc } from '../../../../../src/foundation/nsdoc.js';\n\nimport '../../../../../src/editors/subscription/later-binding/ext-ref-ln-binding-list.js';\n\nimport { newFcdaSelectEvent } from '../../../../../src/editors/subscription/foundation.js';\nimport { ExtRefLnBindingList } from '../../../../../src/editors/subscription/later-binding/ext-ref-ln-binding-list.js';\n\ndescribe('extref-ln-binding-list', async () => {\n  let doc: XMLDocument;\n  let parent: HTMLElement;\n  let element: ExtRefLnBindingList;\n\n  const nsdoc = await initializeNsdoc();\n\n  it('looks like the latest snapshot without a doc loaded', async () => {\n    parent = await fixture(\n      html` <div class=\"container\">\n        <extref-ln-binding-list></extref-ln-binding-list>\n      </div>`\n    );\n    element = <ExtRefLnBindingList>(\n      parent.querySelector('extref-ln-binding-list')\n    );\n    await element.updateComplete;\n\n    await expect(element).shadowDom.to.equalSnapshot();\n  });\n\n  describe('for Sampled Value Control', () => {\n    beforeEach(async () => {\n      doc = await fetch('/test/testfiles/editors/DataBindingSMV2007B4.scd')\n        .then(response => response.text())\n        .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n      parent = await fixture(\n        html` <div class=\"container\">\n          <extref-ln-binding-list\n            .doc=${doc}\n            .nsdoc=${nsdoc}\n            controlTag=\"SampledValueControl\"\n          ></extref-ln-binding-list>\n        </div>`\n      );\n      element = <ExtRefLnBindingList>(\n        parent.querySelector('extref-ln-binding-list')\n      );\n      await element.updateComplete;\n    });\n\n    it('looks like the latest snapshot, but no event fired', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n\n    describe('when SVC has no subscriptions', () => {\n      beforeEach(async () => {\n        const svcElement = doc.querySelector(\n          'IED[name=\"SMV_Publisher\"] SampledValueControl[name=\"fullSmv\"]'\n        )!;\n        const fcdaElement = doc.querySelector(\n          'IED[name=\"SMV_Publisher\"] FCDA[ldInst=\"CurrentTransformer\"][prefix=\"L2\"][lnClass=\"TCTR\"][lnInst=\"1\"][doName=\"AmpSv\"][daName=\"instMag.i\"]'\n        )!;\n\n        element.dispatchEvent(newFcdaSelectEvent(svcElement, fcdaElement));\n        await element.requestUpdate();\n        await element.updateComplete;\n      });\n\n      it('expect the correct number of subscribed elements', () => {\n        expect(element['getSubscribedLNElements']().length).to.be.equal(0);\n      });\n\n      it('expect the correct number of available elements', () => {\n        expect(element['getAvailableLNElements']().length).to.be.equal(8);\n      });\n\n      it('looks like the latest snapshot, when SVC has no subscriptions', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n    });\n\n    describe('when SVC has a single subscriptions', () => {\n      beforeEach(async () => {\n        const svcElement = doc.querySelector(\n          'IED[name=\"SMV_Publisher\"] SampledValueControl[name=\"fullSmv\"]'\n        )!;\n        const fcdaElement = doc.querySelector(\n          'IED[name=\"SMV_Publisher\"] FCDA[ldInst=\"CurrentTransformer\"][prefix=\"L2\"][lnClass=\"TCTR\"][lnInst=\"1\"][doName=\"AmpSv\"][daName=\"q\"]'\n        )!;\n\n        element.dispatchEvent(newFcdaSelectEvent(svcElement, fcdaElement));\n        await element.requestUpdate();\n        await element.updateComplete;\n      });\n\n      it('expect the correct number of subscribed elements', () => {\n        expect(element['getSubscribedLNElements']().length).to.be.equal(1);\n      });\n\n      it('expect the correct number of available elements', () => {\n        expect(element['getAvailableLNElements']().length).to.be.equal(7);\n      });\n\n      it('looks like the latest snapshot, ', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n    });\n  });\n\n  describe('when SVC has a multiple subscriptions', () => {\n    beforeEach(async () => {\n      const svcElement = doc.querySelector(\n        'IED[name=\"SMV_Publisher\"] SampledValueControl[name=\"fullSmv\"]'\n      )!;\n      const fcdaElement = doc.querySelector(\n        'IED[name=\"SMV_Publisher\"] FCDA[ldInst=\"CurrentTransformer\"][prefix=\"L3\"][lnClass=\"TCTR\"][lnInst=\"1\"][doName=\"AmpSv\"][daName=\"instMag.i\"]'\n      )!;\n\n      element.dispatchEvent(newFcdaSelectEvent(svcElement, fcdaElement));\n      await element.requestUpdate();\n      await element.updateComplete;\n    });\n\n    it('validate that some subscribed ExtRef Element will be disabled', async () => {\n      const listItem = element.shadowRoot!.querySelector(\n        'mwc-list-item[value=\"SMV_Subscriber2>>Overvoltage\"]'\n      );\n      expect(listItem).to.have.attribute('disabled');\n    });\n\n    it('validate that some available ExtRef Element will be disabled', async () => {\n      const listItem = element.shadowRoot!.querySelector(\n        'mwc-list-item[value=\"SMV_Subscriber2>>Overcurrent\"]'\n      );\n      expect(listItem).to.have.attribute('disabled');\n    });\n\n    it('expect the correct number of subscribed elements', () => {\n      expect(element['getSubscribedLNElements']().length).to.be.equal(2);\n    });\n\n    it('expect the correct number of available elements', () => {\n      expect(element['getAvailableLNElements']().length).to.be.equal(6);\n    });\n\n    it('looks like the latest snapshot, ', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n  });\n\n  describe('for GOOSE Control', () => {\n    beforeEach(async () => {\n      doc = await fetch('/test/testfiles/editors/DataBindingGOOSE2007B4.scd')\n        .then(response => response.text())\n        .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n      parent = await fixture(\n        html`<div class=\"container\">\n          <extref-ln-binding-list\n            .doc=${doc}\n            .nsdoc=${nsdoc}\n            controlTag=\"GSEControl\"\n          ></extref-ln-binding-list>\n        </div>`\n      );\n      element = <ExtRefLnBindingList>(\n        parent.querySelector('extref-ln-binding-list')\n      );\n      await element.updateComplete;\n    });\n\n    it('looks like the latest snapshot, but no event fired', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n\n    describe('when GSEControl has no subscriptions', () => {\n      beforeEach(async () => {\n        const gseControlElement = doc.querySelector(\n          'IED[name=\"GOOSE_Publisher\"] GSEControl[name=\"GOOSE1\"]'\n        )!;\n        const fcdaElement = doc.querySelector(\n          'IED[name=\"GOOSE_Publisher\"] FCDA[ldInst=\"QB1_Disconnector\"][prefix=\"\"][lnClass=\"CSWI\"][lnInst=\"1\"][doName=\"Pos\"][daName=\"stVal\"]'\n        )!;\n\n        element.dispatchEvent(\n          newFcdaSelectEvent(gseControlElement, fcdaElement)\n        );\n        await element.requestUpdate();\n        await element.updateComplete;\n      });\n\n      it('expect the correct number of subscribed elements', () => {\n        expect(element['getSubscribedLNElements']().length).to.be.equal(0);\n      });\n\n      it('expect the correct number of available elements', () => {\n        expect(element['getAvailableLNElements']().length).to.be.equal(8);\n      });\n\n      it('looks like the latest snapshot, when GSEControl has no subscriptions', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n    });\n\n    describe('when GSEControl has a single subscription', () => {\n      beforeEach(async () => {\n        const gseControlElement = doc.querySelector(\n          'IED[name=\"GOOSE_Publisher\"] GSEControl[name=\"GOOSE2\"]'\n        )!;\n        const fcdaElement = doc.querySelector(\n          'IED[name=\"GOOSE_Publisher\"] FCDA[ldInst=\"QB2_Disconnector\"][prefix=\"\"][lnClass=\"CSWI\"][lnInst=\"1\"][doName=\"Pos\"][daName=\"q\"]'\n        )!;\n\n        element.dispatchEvent(\n          newFcdaSelectEvent(gseControlElement, fcdaElement)\n        );\n        await element.requestUpdate();\n        await element.updateComplete;\n      });\n\n      it('expect the correct number of subscribed elements', () => {\n        expect(element['getSubscribedLNElements']().length).to.be.equal(1);\n      });\n\n      it('expect the correct number of available elements', () => {\n        expect(element['getAvailableLNElements']().length).to.be.equal(7);\n      });\n\n      it('looks like the latest snapshot, ', async () => {\n        await expect(element).shadowDom.to.equalSnapshot();\n      });\n    });\n  });\n\n  describe('when GSEControl has a multiple subscriptions', () => {\n    beforeEach(async () => {\n      const gseControlElement = doc.querySelector(\n        'IED[name=\"GOOSE_Publisher\"] GSEControl[name=\"GOOSE2\"]'\n      )!;\n      const fcdaElement = doc.querySelector(\n        'IED[name=\"GOOSE_Publisher\"] FCDA[ldInst=\"QB2_Disconnector\"][prefix=\"\"][lnClass=\"CSWI\"][lnInst=\"1\"][doName=\"Pos\"][daName=\"stVal\"]'\n      )!;\n\n      element.dispatchEvent(newFcdaSelectEvent(gseControlElement, fcdaElement));\n      await element.requestUpdate();\n      await element.updateComplete;\n    });\n\n    it('validate that some subscribed ExtRef Element will be disabled', async () => {\n      const listItem = element.shadowRoot!.querySelector(\n        'mwc-list-item[value=\"GOOSE_Subscriber1>>Earth_Switch\"]'\n      );\n      expect(listItem).to.have.attribute('disabled');\n    });\n\n    it('validate that some available ExtRef Element will be disabled', async () => {\n      const listItem = element.shadowRoot!.querySelector(\n        'mwc-list-item[value=\"GOOSE_Subscriber1>>Earth_Switch> XSWI 1\"]'\n      );\n      expect(listItem).to.have.attribute('disabled');\n    });\n\n    it('expect the correct number of subscribed elements', () => {\n      expect(element['getSubscribedLNElements']().length).to.be.equal(3);\n    });\n\n    it('expect the correct number of available elements', () => {\n      expect(element['getAvailableLNElements']().length).to.be.equal(5);\n    });\n\n    it('looks like the latest snapshot, ', async () => {\n      await expect(element).shadowDom.to.equalSnapshot();\n    });\n  });\n});\n"]}